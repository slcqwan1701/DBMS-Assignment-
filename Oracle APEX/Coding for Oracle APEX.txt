-- Creating dataset table for listings 

CREATE TABLE listings (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    location VARCHAR2(100),
    price NUMBER,
    rooms NUMBER,
    bathrooms NUMBER,
    car_parks NUMBER,
    property_type VARCHAR2(50),
    furnishing VARCHAR2(50),
    size_sqft NUMBER
);

-- create index

-- single field index
CREATE INDEX idx_location_price
ON listings(location, price);

-- compound index
CREATE INDEX idx_location
ON listings(location);

-- categorical index
CREATE INDEX idx_property_type
ON listings(property_type);


-- Measuring how different indexing strategies affect query performance

-- no index
SELECT 
count(*)
FROM listings
WHERE location = 'KLCC, Kuala Lumpur';

-- single field
SELECT /*+ INDEX(listings idx_location) */
count(*)
FROM listings
WHERE location = 'KLCC, Kuala Lumpur';

-- compound
SELECT /*+ INDEX(listings idx_location_price) */
count(*)
FROM listings
WHERE location = 'KLCC, Kuala Lumpur'
AND price < 1000000;

-- categorical
SELECT /*+ INDEX(listings idx_property_type) */
count(*)
FROM listings
WHERE property_type = 'Condominium (Corner)';